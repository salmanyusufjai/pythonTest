import fastavro
import json

def read_avro_file(file_path):
    with open(file_path, 'rb') as f:
        reader = fastavro.reader(f)
        schema = reader.schema
        records = [record for record in reader]
    return schema, records

def compare_schemas(schema1, schema2):
    return schema1 == schema2

def compare_records(records1, records2):
    return records1 == records2

def main():
    file1 = 'path/to/first-avro-file.avro'
    file2 = 'path/to/second-avro-file.avro'

    schema1, records1 = read_avro_file(file1)
    schema2, records2 = read_avro_file(file2)

    schemas_equal = compare_schemas(schema1, schema2)
    records_equal = compare_records(records1, records2)

    print(f"Schemas are {'equal' if schemas_equal else 'different'}")
    print(f"Records are {'equal' if records_equal else 'different'}")

    # For more detailed differences
    if not schemas_equal:
        print("Differences in schemas:")
        print(json.dumps(schema1, indent=2))
        print(json.dumps(schema2, indent=2))

    if not records_equal:
        print("Differences in records:")
        for record1, record2 in zip(records1, records2):
            if record1 != record2:
                print("Record in first file:")
                print(json.dumps(record1, indent=2))
                print("Record in second file:")
                print(json.dumps(record2, indent=2))
                print("-" * 40)
